"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[640],{3640:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var r=t(4165),s=t(5861),c=t(3433),a=t(9439),l=t(2791),o=t(3359),i=t(2379),d=t(2744),u=t(7689),h=t(3402),m=t(1046),v=t(1243),p=t(184),x=function(){var e,n,t,x,f,j=(0,l.useState)(1),b=(0,a.Z)(j,2),g=b[0],N=b[1],k=(0,d.a)(),y=(0,a.Z)(k,2),C=y[0],Z=(y[1],(0,i.j)()),w=(0,a.Z)(Z,2),I=w[0],P=w[1],S=(0,l.useState)(""),F=(0,a.Z)(S,2),A=F[0],_=F[1],R=(0,l.useState)(""),T=(0,a.Z)(R,2),U=T[0],E=T[1],H=(0,l.useState)(!1),L=(0,a.Z)(H,2),M=L[0],Y=L[1],q=(0,u.s0)(),z=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.Z.get("".concat("http://localhost:8081","/api/v1/product/braintree/token"));case 3:n=e.sent,t=n.data,_(null===t||void 0===t?void 0:t.clientToken),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();(0,l.useEffect)((function(){z()}),[null===C||void 0===C?void 0:C.token]);var D=function(){var e=(0,s.Z)((0,r.Z)().mark((function e(){var n,t,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,Y(!0),e.next=4,U.requestPaymentMethod();case 4:return n=e.sent,t=n.nonce,e.next=8,v.Z.post("".concat("http://localhost:8081","/api/v1/product/braintree/payment"),{nonce:t,cart:I});case 8:s=e.sent,s.data,Y(!1),localStorage.removeItem("cart"),P([]),q("/dashboard/user/orders"),h.ZP.success("Payment Completed Successfully"),e.next=21;break;case 17:e.prev=17,e.t0=e.catch(0),console.log(e.t0),Y(!1);case 21:case"end":return e.stop()}}),e,null,[[0,17]])})));return function(){return e.apply(this,arguments)}}();return(0,p.jsx)(o.Z,{children:(0,p.jsxs)("div",{className:" mainCart",children:[(0,p.jsx)("div",{className:"",children:(0,p.jsxs)("div",{className:"cartUser",children:[(0,p.jsx)("h2",{className:"text-center",children:"Hello ".concat((null===C||void 0===C?void 0:C.token)&&(null===C||void 0===C||null===(e=C.user)||void 0===e?void 0:e.name))}),(0,p.jsx)("h4",{className:"text-center",children:null!==I&&void 0!==I&&I.length?"You Have ".concat(I.length," items in your cart ").concat(null!==C&&void 0!==C&&C.token?"":"please login to checkout"," "):"Your Cart Is Empty"})]})}),(0,p.jsxs)("div",{className:"row",children:[(0,p.jsx)("div",{className:"col-md-8",children:(0,p.jsx)("div",{className:"row",children:null===I||void 0===I?void 0:I.map((function(e){return(0,p.jsxs)("div",{className:"mb-2 p-3 card flex-row cartPageFlex ",children:[(0,p.jsx)("div",{className:"col-md-3 cartItemsLeft",children:(0,p.jsx)("img",{src:"".concat("http://localhost:8081","/api/v1/product/product-photo/").concat(e._id),className:"card-img-top",alt:e.name,height:"150px"})},e._id),(0,p.jsxs)("div",{className:"col-md-8 cartItemsRight",children:[(0,p.jsx)("p",{children:(0,p.jsx)("b",{children:e.name})}),(0,p.jsx)("p",{children:e.description}),(0,p.jsxs)("p",{children:["Price: ",e.price]}),(0,p.jsxs)("div",{className:"my-2 incDec",children:[(0,p.jsx)("span",{className:"border p-1 my-1 ",onClick:function(){return 1===g?g:N(g-1)},children:"-"}),(0,p.jsx)("span",{className:"px-4",children:g}),(0,p.jsx)("span",{className:"border p-1 my-1 ",onClick:function(){return N(g+1)},children:"+"})]}),(0,p.jsx)("button",{className:"btn btn-danger",onClick:function(){return function(e){try{var n=(0,c.Z)(I),t=n.findIndex((function(n){return n._id===e}));n.splice(t,1),P(n),localStorage.setItem("cart",JSON.stringify(n)),h.ZP.error("Item removed successfully")}catch(r){console.log(r)}}(e._id)},children:"Remove"})]})]})}))})}),(0,p.jsxs)("div",{className:"col-md-4 text-center",children:[(0,p.jsx)("h4",{children:"Cart Summary"}),(0,p.jsx)("p",{children:"Total | Checkout | Payment"}),(0,p.jsx)("hr",{}),(0,p.jsxs)("h3",{children:["Total : ",function(){try{var e=0;return null===I||void 0===I||I.map((function(n){e+=n.price,e*=g})),e.toLocaleString("en-IN",{style:"currency",currency:"INR"})}catch(n){console.log(n)}}()]}),null!==C&&void 0!==C&&null!==(n=C.user)&&void 0!==n&&n.address?(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"mb-3",children:[(0,p.jsx)("h4",{children:"Current Address"}),(0,p.jsx)("h5",{children:null===C||void 0===C||null===(t=C.user)||void 0===t?void 0:t.address}),(0,p.jsx)("button",{className:"btn btn-outline-warning",onClick:function(){return q("/dashboard/user/profile")},children:"Update Address"})]})}):(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"mb-3",children:null!==C&&void 0!==C&&C.token?(0,p.jsx)("button",{className:"btn btn-outline-warning",onClick:function(){return q("/dashboard/user/profile")},children:"Update Address"}):(0,p.jsx)("button",{className:"btn btn-outline-warning",onClick:function(){return q("/login",{state:"/cart"})},children:"Please login to Checkout"})})}),(0,p.jsx)("div",{className:"mt-2 cartPayment",children:A&&null!==I&&void 0!==I&&I.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(m.Z,{options:{authorization:A,paypal:{flow:"vault"}},onInstance:function(e){return E(e)}}),(0,p.jsx)("button",{className:"btn btn-primary",onClick:D,disabled:!U||!(null!==C&&void 0!==C&&null!==(x=C.user)&&void 0!==x&&x.address)||!(null!==C&&void 0!==C&&null!==(f=C.user)&&void 0!==f&&f.name),children:M?"Processing ....":" Chose way and Make Payment"})]}):(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("button",{className:"btn btn-success",onClick:function(){return q("/")},children:"Add Items to Cart for payment"})})})]})]})]})})}}}]);
//# sourceMappingURL=640.e2dcdaf4.chunk.js.map