{"version":3,"file":"static/js/640.e2dcdaf4.chunk.js","mappings":"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","sources":["pages/CartPage.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport Layoutt from \"../components/Layout/Layoutt\";\nimport { useCart } from \"../context/cart\";\nimport { useAuth } from \"../context/auth\";\nimport { useNavigate } from \"react-router-dom\";\nimport toast from \"react-hot-toast\";\nimport DropIn from \"braintree-web-drop-in-react\";\nimport axios from \"axios\";\nimport \"../Styles/CartPage.css\";\n\nconst CartPage = () => {\n  const [count, setCount] = useState(1);\n  const [auth, setAuth] = useAuth();\n  const [cart, setCart] = useCart();\n  const [clientToken, setClientToken] = useState(\"\");\n  const [instance, setInstance] = useState(\"\"); // dropIn require\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n\n  // total price\n  const totalPrice = () => {\n    try {\n      let total = 0;\n      cart?.map((item) => {\n        total = total + item.price;\n        total = total * count;\n      });\n      return total.toLocaleString(\"en-IN\", {\n        style: \"currency\",\n        currency: \"INR\",\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  //   delete item\n  const removeCartItem = (pid) => {\n    try {\n      let myCart = [...cart];\n      // if id is equal then gives true\n      let index = myCart.findIndex((item) => item._id === pid);\n      myCart.splice(index, 1); // from index 1 item delete\n      setCart(myCart);\n      // As when we delete in local storage still it exists , so when we refresh the again it comes so in local storage also we are removing the items\n      localStorage.setItem(\"cart\", JSON.stringify(myCart));\n      toast.error(\"Item removed successfully\");\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  // get payment gateway  token\n  const getToken = async () => {\n    try {\n      const { data } = await axios.get(\n        `${process.env.REACT_APP_API}/api/v1/product/braintree/token`\n      );\n      setClientToken(data?.clientToken);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    getToken();\n  }, [auth?.token]);\n\n  // handle payment\n  const handlePayment = async () => {\n    try {\n      setLoading(true);\n      const { nonce } = await instance.requestPaymentMethod();\n      const { data } = await axios.post(\n        `${process.env.REACT_APP_API}/api/v1/product/braintree/payment`,\n        {\n          nonce,\n          cart,\n        }\n      );\n      setLoading(false);\n      // as payment done then our cart must be empty\n      localStorage.removeItem(\"cart\");\n      setCart([]);\n      navigate(\"/dashboard/user/orders\");\n      toast.success(\"Payment Completed Successfully\");\n    } catch (error) {\n      console.log(error);\n      setLoading(false);\n    }\n  };\n\n  return (\n    <Layoutt>\n      <div className=\" mainCart\">\n        <div className=\"\">\n          <div className=\"cartUser\">\n            <h2 className=\"text-center\">\n              {`Hello ${auth?.token && auth?.user?.name}`}\n            </h2>\n            <h4 className=\"text-center\">\n              {cart?.length\n                ? `You Have ${cart.length} items in your cart ${\n                    auth?.token ? \"\" : \"please login to checkout\"\n                  } `\n                : \"Your Cart Is Empty\"}\n            </h4>\n          </div>\n        </div>\n        <div className=\"row\">\n          {/* show cart items  */}\n          <div className=\"col-md-8\">\n            <div className=\"row\">\n              {cart?.map((p) => (\n                <div className=\"mb-2 p-3 card flex-row cartPageFlex \">\n                  {/* left part  */}\n                  <div className=\"col-md-3 cartItemsLeft\" key={p._id}>\n                    <img\n                      src={`${process.env.REACT_APP_API}/api/v1/product/product-photo/${p._id}`}\n                      className=\"card-img-top\"\n                      alt={p.name}\n                      height={\"150px\"}\n                    />\n                  </div>\n                  {/* right part  */}\n                  <div className=\"col-md-8 cartItemsRight\">\n                    <p>\n                      <b>{p.name}</b>\n                    </p>\n                    <p>{p.description}</p>\n                    <p>Price: {p.price}</p>\n                    <div className=\"my-2 incDec\">\n                      <span\n                        className=\"border p-1 my-1 \"\n                        onClick={() =>\n                          count === 1 ? count : setCount(count - 1)\n                        }\n                      >\n                        -\n                      </span>\n                      <span className=\"px-4\">{count}</span>\n                      <span\n                        className=\"border p-1 my-1 \"\n                        onClick={() => setCount(count + 1)}\n                      >\n                        +\n                      </span>\n                    </div>\n                    <button\n                      className=\"btn btn-danger\"\n                      onClick={() => removeCartItem(p._id)}\n                    >\n                      Remove\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* For checkout and card Payment  */}\n          <div className=\"col-md-4 text-center\">\n            <h4>Cart Summary</h4>\n            <p>Total | Checkout | Payment</p>\n            <hr />\n            <h3>Total : {totalPrice()}</h3>\n\n            {auth?.user?.address ? (\n              <>\n                <div className=\"mb-3\">\n                  <h4>Current Address</h4>\n                  <h5>{auth?.user?.address}</h5>\n                  <button\n                    className=\"btn btn-outline-warning\"\n                    onClick={() => navigate(\"/dashboard/user/profile\")}\n                  >\n                    Update Address\n                  </button>\n                </div>\n              </>\n            ) : (\n              <>\n                <div className=\"mb-3\">\n                  {auth?.token ? (\n                    <button\n                      className=\"btn btn-outline-warning\"\n                      onClick={() => navigate(\"/dashboard/user/profile\")}\n                    >\n                      Update Address\n                    </button>\n                  ) : (\n                    <button\n                      className=\"btn btn-outline-warning\"\n                      onClick={() =>\n                        navigate(\"/login\", {\n                          state: \"/cart\", // it means after login cart page will open\n                        })\n                      }\n                    >\n                      Please login to Checkout\n                    </button>\n                  )}\n                </div>\n              </>\n            )}\n\n            <div className=\"mt-2 cartPayment\">\n              {!clientToken || !cart?.length ? (\n                <>\n                  <button\n                    className=\"btn btn-success\"\n                    onClick={() => navigate(\"/\")}\n                  >\n                    Add Items to Cart for payment\n                  </button>\n                </>\n              ) : (\n                <>\n                  <DropIn\n                    options={{\n                      authorization: clientToken,\n                      paypal: {\n                        flow: \"vault\",\n                      },\n                    }}\n                    onInstance={(instance) => setInstance(instance)}\n                  />\n                  <button\n                    className=\"btn btn-primary\"\n                    onClick={handlePayment}\n                    // disabled={!loading || !instance || !auth?.user?.address}\n                    disabled={\n                      !instance || !auth?.user?.address || !auth?.user?.name\n                    }\n                  >\n                    {loading\n                      ? \"Processing ....\"\n                      : \" Chose way and Make Payment\"}\n                  </button>\n                </>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </Layoutt>\n  );\n};\n\nexport default CartPage;\n"],"names":["_auth$user","_auth$user2","_auth$user3","_auth$user4","_auth$user5","_useState","useState","_useState2","_slicedToArray","count","setCount","_useAuth","useAuth","_useAuth2","auth","_useCart","useCart","_useCart2","cart","setCart","_useState3","_useState4","clientToken","setClientToken","_useState5","_useState6","instance","setInstance","_useState7","_useState8","loading","setLoading","navigate","useNavigate","getToken","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_yield$axios$get","data","wrap","_context","prev","next","axios","concat","process","sent","t0","console","log","stop","apply","arguments","useEffect","token","handlePayment","_ref2","_callee2","_yield$instance$reque","nonce","_yield$axios$post","_context2","requestPaymentMethod","localStorage","removeItem","toast","_jsx","Layoutt","children","_jsxs","className","user","name","length","map","p","src","_id","alt","height","description","price","onClick","pid","myCart","_toConsumableArray","index","findIndex","item","splice","setItem","JSON","stringify","error","removeCartItem","total","toLocaleString","style","currency","totalPrice","address","_Fragment","state","DropIn","options","authorization","paypal","flow","onInstance","disabled"],"sourceRoot":""}